---
- name: Bootstrap
  become: true
  hosts: localhost
  connection: local
  vars:
    Username: GlitchWraith
  tasks: 
    - yum_repository:
        name: VSCode
        baseurl: https://packages.microsoft.com/yumrepos/vscode
        description: "Visual Studio Code"
        gpgkey: https://packages.microsoft.com/keys/microsoft.asc
        repo_gpgcheck: yes
    - name:
      file:
        path: /usr/share/fonts/Global
        state: directory
        mode: "0755"        
    - name: Make Fonts Folder from git
      git: 
        repo: https://github.com/GlitchWraith/Resources-Fonts.git
        dest: /usr/share/fonts/Global
    - shell: "fc-cache -v"
#   - name: Install Packages
#      dnf: 
#        name: "{{ packages }}"
#        state: latest
#      vars:
#        packages:
#          - ansible
#          - htop
#          - git
#          - go
#          - code
#          - screen
#          - podman
#          - python3
#          - python3-pip
#          - python3-devel
#          - hwloc-gui
#          - "@development-tools"
#          - gcc-c++
#          - cmake
#          - cairo-devel
#          - automake
#          - pulseaudio-libs
#          - gtk3-devel
#          - unzip
#          - "@virtualization"
#          - zsh
#          - vim
#          - pam-u2f
#          - ffmpeg
#   - name: Install Packages
#      dnf: 
#        name: "{{ groups }}"
#        state: latest
#      vars:
#        groups:
#          - core
#          - multimedia
#          - sound-and-video
    - name: FixUser
      user:
        name: "{{ Username }}"
        groups: wheel,libvirt
        append: yes
        create_home: true
        shell: zsh
    - name: Make Fonts Folder from git
      git: 
        repo: https://github.com/GlitchWraith/Resources-Fonts.git
        dest: "/home/{{ Username }}/powerlevel10k"
    - git:
        repo: "https://github.com/GlitchWraith/HomeLab-R2.git"
        dest: /home/{{ Username }}/GitHub/HomeLab-R2
        update: yes
    - git:
        repo: "https://github.com/VundleVim/Vundle.vim.git"
        dest: /home/{{ Username }}/.vim/bundle/Vundle.vim
        update: yes
    - file:
        path: "/home/{{ Username }}/GitHub/HomeLab-R2"
        state: directory
        owner: "{{ Username }}"
        group: "{{ Username }}"
        recurse: yes
    - file:
        path: "/home/{{ Username }}/.vim"
        state: directory
        owner: "{{ Username }}"
        group: "{{ Username }}"
        recurse: yes
    - name: Copy Postinstall Script
      get_url:
        url: https://raw.githubusercontent.com/GlitchWraith/HomeLab-R2/master/Ansible/Files/PostInstall.sh
        dest: /home/{{ Username }}/PostInstall.sh
    - name: get terraform
      unarchive:
        src: "https://releases.hashicorp.com/terraform/0.12.9/terraform_0.12.9_linux_amd64.zip"
        dest: "/usr/bin/"
        mode: "0751"
        remote_src: yes
        owner: root
        group: wheel
    - name: get packer
      unarchive:
        src: "https://releases.hashicorp.com/packer/1.4.3/packer_1.4.3_linux_amd64.zip"
        dest: "/usr/bin/"
        mode: "0751"
        remote_src: yes
        owner: root
        group: wheel
